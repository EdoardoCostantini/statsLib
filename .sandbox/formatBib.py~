### Title:    Format BibTex files
### Author:   Kyle M. Lang
### Created:  2019-10-30
### Modified: 2019-10-30

iFile = "test1.bib" # Input file name
oFile = "out3.bib"  # Output file name
order = 2           # How to order fields?

import bibtexparser as btp
from bibtexparswer.write import BibTexWriter

with file(iFile) as f0: f0 = btp.load(f0)
    
## Modifying the writer's behavior:
writer = BibTexWriter()
writer.indent = "  "
writer.order_entries_by = ("key", "author", "year")

## How do we want to order the fields?
if order == 0:
    do = ()
elif order == 1:
    do = ("key", "title", "author", "year")
elif order == 2:
   do = ("key",
         "title",
         "booktitle",
         "author",
         "editor",
         "year",
         "month",
         "journal",
         "series",
         "edition",
         "chapter",
         "volume",
         "number",
         "pages",
         "type",
         "publisher",
         "institution",
         "organization",
         "school",
         "address",
         "howpublished",
         "url",
         "link",
         "doi",
         "crossref",
         "abstract",
         "annote",
         "note")
else:
    raise Exception("Invalid value for 'order'")

writer.display_order = do

## Write out the updated BibTex file:
with open(oFile, "w") as out: btp.dump(f0, out, writer)
